---
# tasks file for ans-tomcat-etc
- name: install the latest version of Tomcat
  yum:
    name: "{{item}}"
    state: latest
  with_items:
    - tomcat
    - unzip

- shell: unzip -o -j /vagrant/OpenAM-13.0.0.zip -d /usr/share/tomcat/webapps/
- shell: mv /usr/share/tomcat/webapps/OpenAM-13.0.0.war /usr/share/tomcat/webapps/openam.war

- service:
    name: tomcat
    state: restarted

- pause:
    minutes: 1

- shell: unzip -o /vagrant/SSOConfiguratorTools-13.0.0.zip -d /tmp/openamconf

- template:
    src: templates/openamconf.yaml
    dest: /tmp/openamconf
- shell: java -jar openam-configurator-tool-13.0.0.jar  -f openamconf.yaml
  args:
    chdir: /tmp/openamconf/


- debug: msg="give it 1 minute to deploy and open http://172.16.5.12:8080/openam"


